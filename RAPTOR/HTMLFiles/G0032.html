
<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="RAPTOR.css">
    <link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon">
    <title>Lazarus Group</title>
  </head>
  <body>
    <div class="container">
      <div id="navmenu">
        <ul>
          <li><a href="index.html">Print All</a></li>
          <li><a href="index.html">About</a></li>
          <li class="left"><a href="index.html"><img src="./images/raptor.png" id="logo"></a></li>
        </ul>
      </div>
      <div id="groupmenu">
        <h2>90+%</h2>
          <p><a href="G0130.html">Ajax Security Team</a></p>
        <h2>80% - 89%</h2>
          <p><a href="G0032.html">Lazarus Group</a></p>
        <h2>70% - 79%</h2>
          <p><a href="G0035.html">Dragonfly</a></p>
        <h2>60% - 69%</h2>
          <p><a href="G0006.html">APT1</a></p>
          <p><a href="G0080.html">Cobalt Group</a></p>
        <h2>50% - 59%</h2>
          <p><a href="G0100.html">Inception</a></p>
          <p><a href="G0125.html">HAFNIUM</a></p>
      </div>
      <div id="groupinfo">
        <h1>Lazarus Group</h1>
          <p>[<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>] is a North Korean state-sponsored cyber threat group that has been attributed to the Reconnaissance General Bureau. The group has been active since at least 2009 and was reportedly responsible for the November 2014 destructive wiper attack against Sony Pictures Entertainment as part of a campaign named Operation Blockbuster by Novetta. Malware used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>] correlates to other reported campaigns, including Operation Flame, Operation 1Mission, Operation Troy, DarkSeoul, and Ten Days of Rain. 

North Korean group definitions are known to have significant overlap, and some security researchers report all North Korean state-sponsored cyber activity under the name [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>] instead of tracking clusters or subgroups, such as [<a href="https://attack.mitre.org/groups/G0138">Andariel</a>], [<a href="https://attack.mitre.org/groups/G0067">APT37</a>], [<a href="https://attack.mitre.org/groups/G0082">APT38</a>], and [<a href="https://attack.mitre.org/groups/G0094">Kimsuky</a>].   </p>
        <h2>Associated Groups</h2>
          <p>Guardians of Peace, HIDDEN COBRA, NICKEL ACADEMY, ZINC</p>
        <button id ="button1" class="collapsible">Software</button>
          <div class="content">
            <button id="button2" class="collapsible">AppleJeus</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0584">AppleJeus</a>] is a family of downloaders initially discovered in 2018 embedded within trojanized cryptocurrency applications. [<a href="https://attack.mitre.org/software/S0584">AppleJeus</a>] has been used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>], targeting companies in the energy, finance, government, industry, technology, and telecommunications sectors, and several countries including the United States, United Kingdom, South Korea, Australia, Brazil, New Zealand, and Russia. [<a href="https://attack.mitre.org/software/S0584">AppleJeus</a>] has been used to distribute the [<a href="https://attack.mitre.org/software/S0181">FALLCHILL</a>] RAT.</p>
              </div>
            <button id="button2" class="collapsible">AuditCred</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0347">AuditCred</a>] is a malicious DLL that has been used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>] during their 2018 attacks.</p>
              </div>
            <button id="button2" class="collapsible">BADCALL</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0245">BADCALL</a>] is a Trojan malware variant used by the group [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>]. </p>
              </div>
            <button id="button2" class="collapsible">BLINDINGCAN</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0520">BLINDINGCAN</a>] is a remote access Trojan that has been used by the North Korean government since at least early 2020 in cyber operations against defense, engineering, and government organizations in Western Europe and the US.</p>
              </div>
            <button id="button2" class="collapsible">Bankshot</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0239">Bankshot</a>] is a remote access tool (RAT) that was first reported by the Department of Homeland Security in December of 2017. In 2018, [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>] used the [<a href="https://attack.mitre.org/software/S0239">Bankshot</a>] implant in attacks against the Turkish financial sector. </p>
              </div>
            <button id="button2" class="collapsible">Cryptoistic</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0498">Cryptoistic</a>] is a backdoor, written in Swift, that has been used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>].</p>
              </div>
            <button id="button2" class="collapsible">Dacls</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0497">Dacls</a>] is a multi-platform remote access tool used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>] since at least December 2019.</p>
              </div>
            <button id="button2" class="collapsible">Dtrack</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0567">Dtrack</a>] is spyware that was discovered in 2019 and has been used against Indian financial institutions, research facilities, and the Kudankulam Nuclear Power Plant. [<a href="https://attack.mitre.org/software/S0567">Dtrack</a>] shares similarities with the DarkSeoul campaign, which was attributed to [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>]. </p>
              </div>
            <button id="button2" class="collapsible">ECCENTRICBANDWAGON</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0593">ECCENTRICBANDWAGON</a>] is a remote access Trojan (RAT) used by North Korean cyber actors that was first identified in August 2020. It is a reconnaissance tool--with keylogging and screen capture functionality--used for information gathering on compromised systems.</p>
              </div>
            <button id="button2" class="collapsible">FALLCHILL</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0181">FALLCHILL</a>] is a RAT that has been used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>] since at least 2016 to target the aerospace, telecommunications, and finance industries. It is usually dropped by other [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>] malware or delivered when a victim unknowingly visits a compromised website. </p>
              </div>
            <button id="button2" class="collapsible">HARDRAIN</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0246">HARDRAIN</a>] is a Trojan malware variant reportedly used by the North Korean government. </p>
              </div>
            <button id="button2" class="collapsible">HOPLIGHT</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0376">HOPLIGHT</a>] is a backdoor Trojan that has reportedly been used by the North Korean government.</p>
              </div>
            <button id="button2" class="collapsible">HotCroissant</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0431">HotCroissant</a>] is a remote access trojan (RAT) attributed by U.S. government entities to malicious North Korean government cyber activity, tracked collectively as HIDDEN COBRA. [<a href="https://attack.mitre.org/software/S0431">HotCroissant</a>] shares numerous code similarities with [<a href="https://attack.mitre.org/software/S0433">Rifdoor</a>].</p>
              </div>
            <button id="button2" class="collapsible">KEYMARBLE</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0271">KEYMARBLE</a>] is a Trojan that has reportedly been used by the North Korean government. </p>
              </div>
            <button id="button2" class="collapsible">Proxysvc</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0238">Proxysvc</a>] is a malicious DLL used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>] in a campaign known as Operation GhostSecret. It has appeared to be operating undetected since 2017 and was mostly observed in higher education organizations. The goal of [<a href="https://attack.mitre.org/software/S0238">Proxysvc</a>] is to deliver additional payloads to the target and to maintain control for the attacker. It is in the form of a DLL that can also be executed as a standalone process. </p>
              </div>
            <button id="button2" class="collapsible">RATANKBA</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0241">RATANKBA</a>] is a remote controller tool used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>]. [<a href="https://attack.mitre.org/software/S0241">RATANKBA</a>] has been used in attacks targeting financial institutions in Poland, Mexico, Uruguay, the United Kingdom, and Chile. It was also seen used against organizations related to telecommunications, management consulting, information technology, insurance, aviation, and education. [<a href="https://attack.mitre.org/software/S0241">RATANKBA</a>] has a graphical user interface to allow the attacker to issue jobs to perform on the infected machines.  </p>
              </div>
            <button id="button2" class="collapsible">RawDisk</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0364">RawDisk</a>] is a legitimate commercial driver from the EldoS Corporation that is used for interacting with files, disks, and partitions. The driver allows for direct modification of data on a local computer's hard drive. In some cases, the tool can enact these raw disk modifications from user-mode processes, circumventing Windows operating system security features.</p>
              </div>
            <button id="button2" class="collapsible">TAINTEDSCRIBE</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0586">TAINTEDSCRIBE</a>] is a fully-featured beaconing implant integrated with command modules used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>]. It was first reported in May 2020.</p>
              </div>
            <button id="button2" class="collapsible">TYPEFRAME</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0263">TYPEFRAME</a>] is a remote access tool that has been used by [<a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a>]. </p>
              </div>
            <button id="button2" class="collapsible">Volgmer</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0180">Volgmer</a>] is a backdoor Trojan designed to provide covert access to a compromised system. It has been used since at least 2013 to target the government, financial, automotive, and media industries. Its primary delivery mechanism is suspected to be spearphishing. </p>
              </div>
            <button id="button2" class="collapsible">WannaCry</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0366">WannaCry</a>] is ransomware that was first seen in a global attack during May 2017, which affected more than 150 countries. It contains worm-like features to spread itself across a computer network using the SMBv1 exploit EternalBlue.</p>
              </div>
            <button id="button2" class="collapsible">netsh</button>
              <div class="content">
                <p>[<a href="https://attack.mitre.org/software/S0108">netsh</a>] is a scripting utility used to interact with networking components on local or remote systems. </p>
              </div>
          </div>
        <button id ="button1" class="collapsible">Techniques</button>
          <div class="content">
          <button id="button2" class="collapsible">Account Manipulation</button>
            <div class="content">
              <p>Adversaries may manipulate accounts to maintain access to victim systems. Account manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups. These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials. In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</p>
                  <p>Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</p>
                  <p>Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</p>
                  <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Application Window Discovery</button>
            <div class="content">
              <p>Adversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used or give context to information collected by a keylogger.</p>
            </div>
          <button id="button2" class="collapsible">Archive Collected Data</button>
            <div class="content">
              <p>An adversary may compress and/or encrypt data that is collected prior to exfiltration. Compressing the data can help to obfuscate the collected data and minimize the amount of data sent over the network. Encryption can be used to hide information that is being exfiltrated from detection or make exfiltration less conspicuous upon inspection by a defender.

Both compression and encryption are done prior to exfiltration, and can be performed using a utility, 3rd party library, or custom method.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Archive Collected Data: Archive via Custom Method</button>
            <div class="content">
              <p>An adversary may compress or encrypt data that is collected prior to exfiltration using a custom method. Adversaries may choose to use custom archival methods, such as encryption with XOR or stream ciphers implemented with no external library or utility references. Custom implementations of well-known compression algorithms have also been used.</p>
            </div>
          <button id="button2" class="collapsible">Archive Collected Data: Archive via Library</button>
            <div class="content">
              <p>An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party libraries. Many libraries exist that can archive data, including [<a href="https://attack.mitre.org/techniques/T1059/006">Python</a>] rarfile , libzip , and zlib . Most libraries include functionality to encrypt and/or compress data.

Some archival libraries are preinstalled on systems, such as bzip2 on macOS and Linux, and zip on Windows. Note that the libraries are different from the utilities. The libraries can be linked against when compiling, while the utilities require spawning a subshell, or a similar execution mechanism.</p>
            </div>
          <button id="button2" class="collapsible">Pre-OS Boot: Bootkit</button>
            <div class="content">
              <p>Adversaries may use bootkits to persist on systems. Bootkits reside at a layer below the operating system and may make it difficult to perform full remediation unless an organization suspects one was used and can act accordingly.

A bootkit is a malware variant that modifies the boot sectors of a hard drive, including the Master Boot Record (MBR) and Volume Boot Record (VBR).  The MBR is the section of disk that is first loaded after completing hardware initialization by the BIOS. It is the location of the boot loader. An adversary who has raw access to the boot drive may overwrite this area, diverting execution during startup from the normal boot loader to adversary code. 

The MBR passes control of the boot process to the VBR. Similar to the case of MBR, an adversary who has raw access to the boot drive may overwrite the VBR to divert execution during startup to adversary code.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Boot Integrity - Use secure methods to boot a system and verify the integrity of the operating system and loading mechanisms.</p>
                  <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Signed Binary Proxy Execution: Compiled HTML File</button>
            <div class="content">
              <p>Adversaries may abuse Compiled HTML files (.chm) to conceal malicious code. CHM files are commonly distributed as part of the Microsoft HTML Help system. CHM files are compressed compilations of various content such as HTML documents, images, and scripting/web related programming languages such VBA, JScript, Java, and ActiveX.  CHM content is displayed using underlying components of the Internet Explorer browser  loaded by the HTML Help executable program (hh.exe). 

A custom CHM file containing embedded payloads could be delivered to a victim then triggered by [<a href="https://attack.mitre.org/techniques/T1204">User Execution</a>]. CHM execution may also bypass application application control on older and/or unpatched systems that do not account for execution of binaries through hh.exe.  </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</p>
                  <p>Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Access Token Manipulation: Create Process with Token</button>
            <div class="content">
              <p>Adversaries may create a new process with a different token to escalate privileges and bypass access controls. Processes can be created with the token and resulting security context of another user using features such as <code>CreateProcessWithTokenW</code> and <code>runas</code>.

Creating processes with a different token may require the credentials of the target user, specific privileges to impersonate that user, or access to the token to be used (ex: gathered via other means such as [<a href="https://attack.mitre.org/techniques/T1134/001">Token Impersonation/Theft</a>] or [<a href="https://attack.mitre.org/techniques/T1134/003">Make and Impersonate Token</a>]).</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                  <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Data Destruction</button>
            <div class="content">
              <p>Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources. Data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives. Common operating system file deletion commands such as <code>del</code> and <code>rm</code> often only remove pointers to files without wiping the contents of the files themselves, making the files recoverable by proper forensic methodology. This behavior is distinct from [<a href="https://attack.mitre.org/techniques/T1561/001">Disk Content Wipe</a>] and [<a href="https://attack.mitre.org/techniques/T1561/002">Disk Structure Wipe</a>] because individual files are destroyed rather than sections of a storage disk or the disk's logical structure.

Adversaries may attempt to overwrite files and directories with randomly generated data to make it irrecoverable. In some cases politically oriented image files have been used to overwrite data.

To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware designed for destroying data may have worm-like features to propagate across a network by leveraging additional techniques like [<a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a>], [<a href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a>], and [<a href="https://attack.mitre.org/techniques/T1021/002">SMB/Windows Admin Shares</a>]..

In cloud environments, adversaries may leverage access to delete cloud storage, cloud storage accounts, machine images, and other infrastructure crucial to operations to damage an organization or their customers.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Data Backup - Take and store data backups from end user systems and critical servers. Ensure backup and storage systems are hardened and kept separate from the corporate network to prevent compromise.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Data from Local System</button>
            <div class="content">
              <p>Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.

Adversaries may do this using a [<a href="https://attack.mitre.org/techniques/T1059">Command and Scripting Interpreter</a>], such as [<a href="https://attack.mitre.org/software/S0106">cmd</a>], which has functionality to interact with the file system to gather information. Some adversaries may also use [<a href="https://attack.mitre.org/techniques/T1119">Automated Collection</a>] on the local system.
</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Data Loss Prevention - Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Obtain Capabilities: Digital Certificates</button>
            <div class="content">
              <p>Adversaries may buy and/or steal SSL/TLS certificates that can be used during targeting. SSL/TLS certificates are designed to instill trust. They include information about the key, information about its owner's identity, and the digital signature of an entity that has verified the certificate's contents are correct. If the signature is valid, and the person examining the certificate trusts the signer, then they know they can use that key to communicate with its owner.

Adversaries may purchase or steal SSL/TLS certificates to further their operations, such as encrypting C2 traffic (ex: [<a href="https://attack.mitre.org/techniques/T1573/002">Asymmetric Cryptography</a>] with [<a href="https://attack.mitre.org/techniques/T1071/001">Web Protocols</a>]) or even enabling [<a href="https://attack.mitre.org/techniques/T1557">Adversary-in-the-Middle</a>] if the certificate is trusted or otherwise added to the root of trust (i.e. [<a href="https://attack.mitre.org/techniques/T1553/004">Install Root Certificate</a>]). The purchase of digital certificates may be done using a front organization or using information stolen from a previously compromised entity that allows the adversary to validate to a certificate provider as that entity. Adversaries may also steal certificate materials directly from a compromised third-party, including from certificate authorities. Adversaries may register or hijack domains that they will later purchase an SSL/TLS certificate for.

Certificate authorities exist that allow adversaries to acquire SSL/TLS certificates, such as domain validation certificates, for free.

After obtaining a digital certificate, an adversary may then install that certificate (see [<a href="https://attack.mitre.org/techniques/T1608/003">Install Digital Certificate</a>]) on infrastructure under their control.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Impair Defenses: Disable or Modify System Firewall</button>
            <div class="content">
              <p>Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.

Modifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</p>
                  <p>Restrict Registry Permissions - Restrict the ability to modify certain hives or keys in the Windows Registry.</p>
                  <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Impair Defenses: Disable or Modify Tools</button>
            <div class="content">
              <p>Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take the many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information.

Adversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [<a href="https://attack.mitre.org/techniques/T1562/006">Indicator Blocking</a>], adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</p>
                  <p>Restrict Registry Permissions - Restrict the ability to modify certain hives or keys in the Windows Registry.</p>
                  <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Disk Wipe: Disk Content Wipe</button>
            <div class="content">
              <p>Adversaries may erase the contents of storage devices on specific systems or in large numbers in a network to interrupt availability to system and network resources.

Adversaries may partially or completely overwrite the contents of a storage device rendering the data irrecoverable through the storage interface. Instead of wiping specific disk structures or files, adversaries with destructive intent may wipe arbitrary portions of disk content. To wipe disk content, adversaries may acquire direct access to the hard drive in order to overwrite arbitrarily sized portions of disk with random data. Adversaries have been observed leveraging third-party drivers like [<a href="https://attack.mitre.org/software/S0364">RawDisk</a>] to directly access disk content. This behavior is distinct from [<a href="https://attack.mitre.org/techniques/T1485">Data Destruction</a>] because sections of the disk are erased instead of individual files.

To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware used for wiping disk content may have worm-like features to propagate across a network by leveraging additional techniques like [<a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a>], [<a href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a>], and [<a href="https://attack.mitre.org/techniques/T1021/002">SMB/Windows Admin Shares</a>].</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Data Backup - Take and store data backups from end user systems and critical servers. Ensure backup and storage systems are hardened and kept separate from the corporate network to prevent compromise.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Disk Wipe: Disk Structure Wipe</button>
            <div class="content">
              <p>Adversaries may corrupt or wipe the disk data structures on a hard drive necessary to boot a system; targeting specific critical systems or in large numbers in a network to interrupt availability to system and network resources. 

Adversaries may attempt to render the system unable to boot by overwriting critical data located in structures such as the master boot record (MBR) or partition table. The data contained in disk structures may include the initial executable code for loading an operating system or the location of the file system partitions on disk. If this information is not present, the computer will not be able to load an operating system during the boot process, leaving the computer unavailable. [<a href="https://attack.mitre.org/techniques/T1561/002">Disk Structure Wipe</a>] may be performed in isolation, or along with [<a href="https://attack.mitre.org/techniques/T1561/001">Disk Content Wipe</a>] if all sectors of a disk are wiped.

To maximize impact on the target organization, malware designed for destroying disk structures may have worm-like features to propagate across a network by leveraging other techniques like [<a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a>], [<a href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a>], and [<a href="https://attack.mitre.org/techniques/T1021/002">SMB/Windows Admin Shares</a>].</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Data Backup - Take and store data backups from end user systems and critical servers. Ensure backup and storage systems are hardened and kept separate from the corporate network to prevent compromise.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Acquire Infrastructure: Domains</button>
            <div class="content">
              <p>Adversaries may purchase domains that can be used during targeting. Domain names are the human readable names used to represent one or more IP addresses. They can be purchased or, in some cases, acquired for free.

Adversaries can use purchased domains for a variety of purposes, including for [<a href="https://attack.mitre.org/techniques/T1566">Phishing</a>], [<a href="https://attack.mitre.org/techniques/T1189">Drive-by Compromise</a>], and Command and Control. Adversaries may choose domains that are similar to legitimate domains, including through use of homoglyphs or use of a different top-level domain (TLD). Typosquatting may be used to aid in delivery of payloads via [<a href="https://attack.mitre.org/techniques/T1189">Drive-by Compromise</a>]. Adversaries can also use internationalized domain names (IDNs) to create visually similar lookalike domains for use in operations.

Domain registrars each maintain a publicly viewable database that displays contact information for every registered domain. Private WHOIS services display alternative information, such as their own company data, rather than the owner of the domain. Adversaries may use such private WHOIS services to obscure information about who owns a purchased domain. Adversaries may further interrupt efforts to track their infrastructure by using varied registration information and purchasing domains with different domain registrars.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Drive-by Compromise</button>
            <div class="content">
              <p>Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user's web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring [<a href="https://attack.mitre.org/techniques/T1550/001">Application Access Token</a>].

Multiple ways of delivering exploit code to a browser exist, including:

* A legitimate website is compromised where adversaries have injected some form of malicious code such as JavaScript, iFrames, and cross-site scripting.
* Malicious ads are paid for and served through legitimate ad providers.
* Built-in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client (e.g. forum posts, comments, and other user controllable web content).

Often the website used by an adversary is one visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted attack is referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.

Typical drive-by compromise process:

1. A user visits a website that is used to host the adversary controlled content.
2. Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version. 
    * The user may be required to assist in this process by enabling scripting or active website components and ignoring warning dialog boxes.
3. Upon finding a vulnerable version, exploit code is delivered to the browser.
4. If exploitation is successful, then it will give the adversary code execution on the user's system unless other protections are in place.
    * In some cases a second visit to the website after the initial scan is required before exploit code is delivered.

Unlike [<a href="https://attack.mitre.org/techniques/T1190">Exploit Public-Facing Application</a>], the focus of this technique is to exploit software on a client endpoint upon visiting a website. This will commonly give an adversary access to systems on the internal network instead of external systems that may be in a DMZ.

Adversaries may also use compromised websites to deliver a user to a malicious application designed to [<a href="https://attack.mitre.org/techniques/T1528">Steal Application Access Token</a>]s, like OAuth tokens, to gain access to protected applications and information. These malicious applications have been delivered through popups on legitimate websites.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Application Isolation and Sandboxing - Restrict execution of code to a virtual environment on or in transit to an endpoint system.</p>
                  <p>Exploit Protection - Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.</p>
                  <p>Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</p>
                  <p>Update Software - Perform regular software updates to mitigate exploitation risk.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Process Injection: Dynamic-link Library Injection</button>
            <div class="content">
              <p>Adversaries may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges. DLL injection is a method of executing arbitrary code in the address space of a separate live process.  

DLL injection is commonly performed by writing the path to a DLL in the virtual address space of the target process before loading the DLL by invoking a new thread. The write can be performed with native Windows API calls such as <code>VirtualAllocEx</code> and <code>WriteProcessMemory</code>, then invoked with <code>CreateRemoteThread</code> (which calls the <code>LoadLibrary</code> API responsible for loading the DLL).  

Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue as well as the additional APIs to invoke execution (since these methods load and execute the files in memory by manually preforming the function of <code>LoadLibrary</code>). 

Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via DLL injection may also evade detection from security products since the execution is masked under a legitimate process. </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Exfiltration Over C2 Channel</button>
            <div class="content">
              <p>Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Data Loss Prevention - Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.</p>
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol</button>
            <div class="content">
              <p>Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. 

Adversaries may opt to obfuscate this data, without the use of encryption, within network protocols that are natively unencrypted (such as HTTP, FTP, or DNS). This may include custom or publicly available encoding/compression algorithms (such as base64) as well as embedding data within protocol headers and fields. </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Data Loss Prevention - Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.</p>
                  <p>Filter Network Traffic - Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.</p>
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                  <p>Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Exploitation for Client Execution</button>
            <div class="content">
              <p>Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.

Several types exist:

### Browser-based Exploitation

Web browsers are a common target through [<a href="https://attack.mitre.org/techniques/T1189">Drive-by Compromise</a>] and [<a href="https://attack.mitre.org/techniques/T1566/002">Spearphishing Link</a>]. Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed.

### Office Applications

Common office and productivity applications such as Microsoft Office are also targeted through [<a href="https://attack.mitre.org/techniques/T1566">Phishing</a>]. Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run.

### Common Third-party Applications

Other applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Application Isolation and Sandboxing - Restrict execution of code to a virtual environment on or in transit to an endpoint system.</p>
                  <p>Exploit Protection - Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Proxy: External Proxy</button>
            <div class="content">
              <p>Adversaries may use an external proxy to act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including [<a href="https://attack.mitre.org/software/S0040">HTRAN</a>], ZXProxy, and ZXPortMap.  Adversaries use these types of proxies to manage command and control communications, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths to avoid suspicion.

External connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the Internet and then the proxy would forward communications to the C2 server.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Fallback Channels</button>
            <div class="content">
              <p>Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Indicator Removal on Host: File Deletion</button>
            <div class="content">
              <p>Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.

There are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native [<a href="https://attack.mitre.org/software/S0106">cmd</a>] functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. </p>
            </div>
          <button id="button2" class="collapsible">File and Directory Discovery</button>
            <div class="content">
              <p>Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [<a href="https://attack.mitre.org/techniques/T1083">File and Directory Discovery</a>] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>. Custom tools may also be used to gather file and directory information and interact with the [<a href="https://attack.mitre.org/techniques/T1106">Native API</a>].</p>
            </div>
          <button id="button2" class="collapsible">Hide Artifacts: Hidden Files and Directories</button>
            <div class="content">
              <p>Adversaries may set files and directories to be hidden to evade detection mechanisms. To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a hidden file. These files dont show up when a user browses the file system with a GUI or when using normal commands on the command line. Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (<code>dir /a</code> for Windows and <code>ls a</code> for Linux and macOS).

On Linux and Mac, users can mark specific files as hidden simply by putting a . as the first character in the file or folder name   . Files and folders that start with a period, ., are by default hidden from being viewed in the Finder application and standard command-line utilities like ls. Users must specifically change settings to have these files viewable.

Files on macOS can also be marked with the UF_HIDDEN flag which prevents them from being seen in Finder.app, but still allows them to be seen in Terminal.app . On Windows, users can mark specific files as hidden by using the attrib.exe binary. Many applications create these hidden files and folders to store information so that it doesnt clutter up the users workspace. For example, SSH utilities create a .ssh folder thats hidden and contains the users known hosts and keys.

Adversaries can use this to their advantage to hide files and folders anywhere on the system and evading a typical user or system analysis that does not incorporate investigation of hidden files.</p>
            </div>
          <button id="button2" class="collapsible">Ingress Tool Transfer</button>
            <div class="content">
              <p>Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Defacement: Internal Defacement</button>
            <div class="content">
              <p>An adversary may deface systems internal to an organization in an attempt to intimidate or mislead users. This may take the form of modifications to internal websites, or directly to user systems with the replacement of the desktop wallpaper. Disturbing or offensive images may be used as a part of [<a href="https://attack.mitre.org/techniques/T1491/001">Internal Defacement</a>] in order to cause user discomfort, or to pressure compliance with accompanying messages. Since internally defacing systems exposes an adversary's presence, it often takes place after other intrusion goals have been accomplished.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Data Backup - Take and store data backups from end user systems and critical servers. Ensure backup and storage systems are hardened and kept separate from the corporate network to prevent compromise.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Input Capture: Keylogging</button>
            <div class="content">
              <p>Adversaries may log user keystrokes to intercept credentials as the user types them. Keylogging is likely to be used to acquire credentials for new access opportunities when [<a href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a>] efforts are not effective, and may require an adversary to intercept keystrokes on a system for a substantial period of time before credentials can be successfully captured.

Keylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes. Some methods include:

* Hooking API callbacks used for processing keystrokes. Unlike [<a href="https://attack.mitre.org/techniques/T1056/004">Credential API Hooking</a>], this focuses solely on API functions intended for processing keystroke data.
* Reading raw keystroke data from the hardware buffer.
* Windows Registry modifications.
* Custom drivers.
* [<a href="https://attack.mitre.org/techniques/T1601">Modify System Image</a>] may provide adversaries with hooks into the operating system of network devices to read raw keystrokes for login sessions. </p>
            </div>
          <button id="button2" class="collapsible">Data Staged: Local Data Staging</button>
            <div class="content">
              <p>Adversaries may stage collected data in a central location or directory on the local system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [<a href="https://attack.mitre.org/techniques/T1560">Archive Collected Data</a>]. Interactive command shells may be used, and common functionality within [<a href="https://attack.mitre.org/software/S0106">cmd</a>] and bash may be used to copy data into a staging location.</p>
            </div>
          <button id="button2" class="collapsible">User Execution: Malicious File</button>
            <div class="content">
              <p>An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from [<a href="https://attack.mitre.org/techniques/T1566/001">Spearphishing Attachment</a>]. Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl.

Adversaries may employ various forms of [<a href="https://attack.mitre.org/techniques/T1036">Masquerading</a>] on the file to increase the likelihood that a user will open it.

While [<a href="https://attack.mitre.org/techniques/T1204/002">Malicious File</a>] frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [<a href="https://attack.mitre.org/techniques/T1534">Internal Spearphishing</a>].</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</p>
                  <p>Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</p>
                  <p>User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Develop Capabilities: Malware</button>
            <div class="content">
              <p>Adversaries may develop malware and malware components that can be used during targeting. Building malicious software can include the development of payloads, droppers, post-compromise tools, backdoors (including backdoored images), packers, C2 protocols, and the creation of infected removable media. Adversaries may develop malware to support their operations, creating a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.

As with legitimate development efforts, different skill sets may be required for developing malware. The skills needed may be located in-house, or may need to be contracted out. Use of a contractor may be considered an extension of that adversary's malware development capabilities, provided the adversary plays a role in shaping requirements and maintains a degree of exclusivity to the malware.

Some aspects of malware development, such as C2 protocol development, may require adversaries to obtain additional infrastructure. For example, malware developed that will communicate with Twitter for C2, may require use of [<a href="https://attack.mitre.org/techniques/T1583/006">Web Services</a>].</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Masquerading: Match Legitimate Name or Location</button>
            <div class="content">
              <p>Adversaries may match or approximate the name or location of legitimate files or resources when naming/placing them. This is done for the sake of evading defenses and observation. This may be done by placing an executable in a commonly trusted directory (ex: under System32) or giving it the name of a legitimate, trusted program (ex: svchost.exe). In containerized environments, this may also be done by creating a resource in a namespace that matches the naming convention of a container pod or cluster. Alternatively, a file or container image name given may be a close approximation to legitimate programs/images or something innocuous.

Adversaries may also use the same icon of the file they are trying to mimic.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Code Signing - Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.</p>
                  <p>Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</p>
                  <p>Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Non-Standard Port</button>
            <div class="content">
              <p>Adversaries may communicate using a protocol and port paring that are typically not associated. For example, HTTPS over port 8088 or port 587 as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                  <p>Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Obfuscated Files or Information</button>
            <div class="content">
              <p>Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. 

Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [<a href="https://attack.mitre.org/techniques/T1140">Deobfuscate/Decode Files or Information</a>] for [<a href="https://attack.mitre.org/techniques/T1204">User Execution</a>]. The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary.  Adversaries may also used compressed or archived scripts, such as JavaScript. 

Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery.  Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. 

Adversaries may also obfuscate commands executed from payloads or directly via a [<a href="https://attack.mitre.org/techniques/T1059">Command and Scripting Interpreter</a>]. Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms.   </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</p>
                  <p>Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Brute Force: Password Spraying</button>
            <div class="content">
              <p>Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. 

Typically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition to management services, adversaries may "target single sign-on (SSO) and cloud-based applications utilizing federated authentication protocols," as well as externally facing email applications, such as Office 365.

In default environments, LDAP and Kerberos connection attempts are less likely to trigger events over SMB, which creates Windows "logon failure" event ID 4625.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Account Use Policies - Configure features related to account use like login attempt lockouts, specific login times, etc.</p>
                  <p>Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</p>
                  <p>Password Policies - Set and enforce secure password policies for accounts.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Process Discovery</button>
            <div class="content">
              <p>Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [<a href="https://attack.mitre.org/techniques/T1057">Process Discovery</a>] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

In Windows environments, adversaries could obtain details on running processes using the [<a href="https://attack.mitre.org/software/S0057">Tasklist</a>] utility via [<a href="https://attack.mitre.org/software/S0106">cmd</a>] or <code>Get-Process</code> via [<a href="https://attack.mitre.org/techniques/T1059/001">PowerShell</a>]. Information about processes can also be extracted from the output of [<a href="https://attack.mitre.org/techniques/T1106">Native API</a>] calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.</p>
            </div>
          <button id="button2" class="collapsible">Data Obfuscation: Protocol Impersonation</button>
            <div class="content">
              <p>Adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts. By impersonating legitimate protocols or web services, adversaries can make their command and control traffic blend in with legitimate network traffic.  

Adversaries may impersonate a fake SSL/TLS handshake to make it look like subsequent traffic is SSL/TLS encrypted, potentially interfering with some security tooling, or to make the traffic look like it is related with a trusted entity. </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Query Registry</button>
            <div class="content">
              <p>Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.

The Registry contains a significant amount of information about the operating system, configuration, software, and security. Information can easily be queried using the [<a href="https://attack.mitre.org/software/S0075">Reg</a>] utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [<a href="https://attack.mitre.org/techniques/T1012">Query Registry</a>] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.</p>
            </div>
          <button id="button2" class="collapsible">Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</button>
            <div class="content">
              <p>Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the "run keys" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.  These programs will be executed under the context of the user and will have the account's associated permissions level.

Placing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\Users\\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code>. The startup folder path for all users is <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code>.

The following run keys are created by default on Windows systems:

* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>

Run keys may exist under multiple hives. The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.  For example, it is possible to load a DLL at logon using a "Depend" key with RunOnceEx: <code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d "C:\temp\evil[.]dll"</code> 

The following Registry keys can be used to set startup folder items for persistence:

* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code>

The following Registry keys can control automatic startup of services during boot:

* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</code>

Using policy settings to specify startup programs creates corresponding values in either of two Registry keys:

* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>

The Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code> and <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> subkeys can automatically launch programs.

Programs listed in the load value of the registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> run when any user logs on.

By default, the multistring <code>BootExecute</code> value of the registry key <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> is set to <code>autocheck autochk *</code>. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.

Adversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [<a href="https://attack.mitre.org/techniques/T1036">Masquerading</a>] to make the Registry entries look as if they are associated with legitimate programs.</p>
            </div>
          <button id="button2" class="collapsible">Remote Services: Remote Desktop Protocol</button>
            <div class="content">
              <p>Adversaries may use [<a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a>] to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.

Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). 

Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [<a href="https://attack.mitre.org/techniques/T1546/008">Accessibility Features</a>] technique for Persistence.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</p>
                  <p>Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</p>
                  <p>Limit Access to Resource Over Network - Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.</p>
                  <p>Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</p>
                  <p>Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</p>
                  <p>Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</p>
                  <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                  <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Remote Services: SMB/Windows Admin Shares</button>
            <div class="content">
              <p>Adversaries may use [<a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a>] to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.

SMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba.

Windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include `C$`, `ADMIN$`, and `IPC$`. Adversaries may use this technique in conjunction with administrator-level [<a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a>] to remotely access a networked system over SMB, to interact with systems using remote procedure calls (RPCs), transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [<a href="https://attack.mitre.org/techniques/T1053">Scheduled Task/Job</a>], [<a href="https://attack.mitre.org/techniques/T1569/002">Service Execution</a>], and [<a href="https://attack.mitre.org/techniques/T1047">Windows Management Instrumentation</a>]. Adversaries can also use NTLM hashes to access administrator shares on systems with [<a href="https://attack.mitre.org/techniques/T1550/002">Pass the Hash</a>] and certain configuration and patch levels.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Filter Network Traffic - Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.</p>
                  <p>Limit Access to Resource Over Network - Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.</p>
                  <p>Password Policies - Set and enforce secure password policies for accounts.</p>
                  <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Service Stop</button>
            <div class="content">
              <p>Adversaries may stop or disable services on a system to render those services unavailable to legitimate users. Stopping critical services or processes can inhibit or stop response to an incident or aid in the adversary's overall objectives to cause damage to the environment. 

Adversaries may accomplish this by disabling individual services of high importance to an organization, such as <code>MSExchangeIS</code>, which will make Exchange content inaccessible . In some cases, adversaries may stop or disable many or all services to render systems unusable. Services or processes may not allow for modification of their data stores while running. Adversaries may stop services or processes in order to conduct [<a href="https://attack.mitre.org/techniques/T1485">Data Destruction</a>] or [<a href="https://attack.mitre.org/techniques/T1486">Data Encrypted for Impact</a>] on the data stores of services like Exchange and SQL Server.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</p>
                  <p>Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</p>
                  <p>Restrict Registry Permissions - Restrict the ability to modify certain hives or keys in the Windows Registry.</p>
                  <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Boot or Logon Autostart Execution: Shortcut Modification</button>
            <div class="content">
              <p>Adversaries may create or edit shortcuts to run a program during system boot or user login. Shortcuts or symbolic links are ways of referencing other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process.

Adversaries could use shortcuts to execute their tools for persistence. They may create a new shortcut as a means of indirection that may use [<a href="https://attack.mitre.org/techniques/T1036">Masquerading</a>] to look like a legitimate program. Adversaries could also edit the target path or entirely replace an existing shortcut so their tools will be executed instead of the intended legitimate program.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Phishing: Spearphishing Attachment</button>
            <div class="content">
              <p>Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [<a href="https://attack.mitre.org/techniques/T1204">User Execution</a>] to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.

There are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one. </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</p>
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                  <p>Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</p>
                  <p>Software Configuration - Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.</p>
                  <p>User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Data Encoding: Standard Encoding</button>
            <div class="content">
              <p>Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.  Some data encoding systems may also result in data compression, such as gzip.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Encrypted Channel: Symmetric Cryptography</button>
            <div class="content">
              <p>Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, and RC4.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">System Information Discovery</button>
            <div class="content">
              <p>An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [<a href="https://attack.mitre.org/techniques/T1082">System Information Discovery</a>] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Tools such as [<a href="https://attack.mitre.org/software/S0096">Systeminfo</a>] can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. [<a href="https://attack.mitre.org/techniques/T1082">System Information Discovery</a>] combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.

Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.</p>
            </div>
          <button id="button2" class="collapsible">System Network Configuration Discovery</button>
            <div class="content">
              <p>Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [<a href="https://attack.mitre.org/software/S0099">Arp</a>], [<a href="https://attack.mitre.org/software/S0100">ipconfig</a>]/[<a href="https://attack.mitre.org/software/S0101">ifconfig</a>], [<a href="https://attack.mitre.org/software/S0102">nbtstat</a>], and [<a href="https://attack.mitre.org/software/S0103">route</a>].

Adversaries may use the information from [<a href="https://attack.mitre.org/techniques/T1016">System Network Configuration Discovery</a>] during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. </p>
            </div>
          <button id="button2" class="collapsible">System Owner/User Discovery</button>
            <div class="content">
              <p>Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [<a href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a>]. The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [<a href="https://attack.mitre.org/techniques/T1033">System Owner/User Discovery</a>] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Various utilities and commands may acquire this information, including <code>whoami</code>. In macOS and Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>. On macOS the <code>dscl . list /Users | grep -v '_'</code> command can also be used to enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information.</p>
            </div>
          <button id="button2" class="collapsible">System Shutdown/Reboot</button>
            <div class="content">
              <p>Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands to initiate a shutdown/reboot of a machine. In some cases, these commands may also be used to initiate a shutdown/reboot of a remote computer. Shutting down or rebooting systems may disrupt access to computer resources for legitimate users.

Adversaries may attempt to shutdown/reboot a system after impacting it in other ways, such as [<a href="https://attack.mitre.org/techniques/T1561/002">Disk Structure Wipe</a>] or [<a href="https://attack.mitre.org/techniques/T1490">Inhibit System Recovery</a>], to hasten the intended effects on system availability.</p>
            </div>
          <button id="button2" class="collapsible">System Time Discovery</button>
            <div class="content">
              <p>An adversary may gather the system time and/or time zone from a local or remote system. The system time is set and stored by the Windows Time Service within a domain to maintain time synchronization between systems and services in an enterprise network.  

System time information may be gathered in a number of ways, such as with [<a href="https://attack.mitre.org/software/S0039">Net</a>] on Windows by performing <code>net time \\hostname</code> to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using <code>w32tm /tz</code>. 

This information could be useful for performing other techniques, such as executing a file with a [<a href="https://attack.mitre.org/techniques/T1053">Scheduled Task/Job</a>] , or to discover locality information based on time zone to assist in victim targeting (i.e. [<a href="https://attack.mitre.org/techniques/T1614">System Location Discovery</a>]). Adversaries may also use knowledge of system time as part of a time bomb, or delaying execution until a specified date/time.</p>
            </div>
          <button id="button2" class="collapsible">Indicator Removal on Host: Timestomp</button>
            <div class="content">
              <p>Adversaries may modify file time attributes to hide new or changes to existing files. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder. This is done, for example, on files that have been modified or created by the adversary so that they do not appear conspicuous to forensic investigators or file analysis tools.

Timestomping may be used along with file name [<a href="https://attack.mitre.org/techniques/T1036">Masquerading</a>] to hide malware and tools.</p>
            </div>
          <button id="button2" class="collapsible">Application Layer Protocol: Web Protocols</button>
            <div class="content">
              <p>Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Protocols such as HTTP and HTTPS that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Acquire Infrastructure: Web Services</button>
            <div class="content">
              <p>Adversaries may register for web servicesthat can be used during targeting. A variety of popular websites exist for adversaries to register for a web-based service that can be abused during later stages of the adversary lifecycle, such as during Command and Control ([<a href="https://attack.mitre.org/techniques/T1102">Web Service</a>]) or [<a href="https://attack.mitre.org/techniques/T1567">Exfiltration Over Web Service</a>]. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. By utilizing a web service, adversaries can make it difficult to physically tie back operations to them.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Command and Scripting Interpreter: Windows Command Shell</button>
            <div class="content">
              <p>Adversaries may abuse the Windows command shell for execution. The Windows command shell ([<a href="https://attack.mitre.org/software/S0106">cmd</a>]) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via [<a href="https://attack.mitre.org/techniques/T1021">Remote Services</a>] such as [<a href="https://attack.mitre.org/techniques/T1021/004">SSH</a>].

Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems.

Adversaries may leverage [<a href="https://attack.mitre.org/software/S0106">cmd</a>] to execute various commands and payloads. Common uses include [<a href="https://attack.mitre.org/software/S0106">cmd</a>] to execute a single command, or abusing [<a href="https://attack.mitre.org/software/S0106">cmd</a>] interactively with input and output forwarded over a command and control channel.</p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Windows Management Instrumentation</button>
            <div class="content">
              <p>Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is an administration feature that provides a uniform environment to access Windows system components. The WMI service enables both local and remote access, though the latter is facilitated by [<a href="https://attack.mitre.org/techniques/T1021">Remote Services</a>] such as [<a href="https://attack.mitre.org/techniques/T1021/003">Distributed Component Object Model</a>] (DCOM) and [<a href="https://attack.mitre.org/techniques/T1021/006">Windows Remote Management</a>] (WinRM).  Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS.  

An adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for Discovery as well as remote Execution of files as part of Lateral Movement.  </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</p>
                  <p>Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</p>
                  <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                  <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                </div>
            </div>
          <button id="button2" class="collapsible">Create or Modify System Process: Windows Service</button>
            <div class="content">
              <p>Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions. Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry. Service configurations can be modified using utilities such as sc.exe and [<a href="https://attack.mitre.org/software/S0075">Reg</a>]. 

Adversaries may install a new service or modify an existing service by using system utilities to interact with services, by directly modifying the Registry, or by using custom tools to interact with the Windows API. Adversaries may configure services to execute at startup in order to persist on a system.

An adversary may also incorporate [<a href="https://attack.mitre.org/techniques/T1036">Masquerading</a>] by using a service name from a related operating system or benign software, or by modifying existing services to make detection analysis more challenging. Modifying existing services may interrupt their functionality or may enable services that are disabled or otherwise not commonly used. 

Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges from administrator to SYSTEM. Adversaries may also directly start services through [<a href="https://attack.mitre.org/techniques/T1569/002">Service Execution</a>]. </p>
              <button id="button3" class="collapsible">Mitigations</button>
                <div class="content">
                  <p>Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</p>
                  <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                </div>
            </div>
          </div>
      </div>
      <div id="footer">
        <ul>
          <li><a href="https://github.com/redbeardmeric/APTAnalyzer"><img src="./images/Github.png"></a></li>
          <li><a href="https://attack.mitre.org/"><img src="./images/Attck.png"></a></li>
        </ul>
      </div>
    </div>
    <script>
      var coll = document.getElementsByClassName("collapsible");
      var i;
      for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function(){
          this.classList.toggle("active");
          var content = this.nextElementSibling;
          if (content.style.maxHeight){
            content.style.maxHeight = null;
          } else {
            content.style.maxHeight = 1000000 + "px";
          } 
        });
      }
    </script>
  </body>
</html>