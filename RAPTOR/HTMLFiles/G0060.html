
        <!DOCTYPE html>
        <html style="font-size: 16px;">
          <head>
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta charset="utf-8">
            <meta name="keywords" content="90+%, 89% - 80%, 79% - 70%, 69% - 60%, 59% - 50%, APT Name, Description, Associated Groups, Software, Techniques">
            <meta name="description" content="">
            <meta name="page_type" content="np-template-header-footer-from-plugin"><title>G0060</title>
            <link rel="stylesheet" href="nicepage.css" media="screen">
        <link rel="stylesheet" href="groupPage.css" media="screen">
            <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
            <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
            <meta name="generator" content="Nicepage 4.8.2, nicepage.com">
            <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
            
            
            <script type="application/ld+json">{
                        "@context": "http://schema.org",
                        "@type": "Organization",
                        "name": "",
                        "logo": "images/raptor.png",
                        "sameAs": [
                                        "https://github.com/redbeardmeric/APTAnalyzer",
                                        "https://attack.mitre.org/"
                        ]
        }</script>
            <meta name="theme-color" content="#478ac9"><meta property="og:title" content="G0060">
            <meta property="og:type" content="website">
          </head>
          <body class="u-body u-xl-mode"><header class="u-border-3 u-border-custom-color-1 u-clearfix u-header u-header" id="sec-2f7b"><div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
                <a href="https://nicepage.com" class="u-image u-logo u-image-1" data-image-width="256" data-image-height="256">
                  <img src="images/raptor.png" class="u-logo-image u-logo-image-1">
                </a>
                <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
                  <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
                    <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-color u-custom-text-hover-color u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
                      <svg class="u-svg-link" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
                      <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
        </g></svg>
                    </a>
                  </div>
                  <div class="u-custom-menu u-nav-container">
                    <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-custom-color-1 u-text-hover-white" href="Home.html" style="padding: 10px 20px;">Home</a>
        </li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-custom-color-1 u-text-hover-white" href="About.html" style="padding: 10px 20px;">About</a>
        </li></ul>
                  </div>
                  <div class="u-custom-menu u-nav-container-collapse">
                    <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
                      <div class="u-inner-container-layout u-sidenav-overflow">
                        <div class="u-menu-close"></div>
                        <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Home.html">Home</a>
        </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="About.html">About</a>
        </li></ul>
                      </div>
                    </div>
                    <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
                  </div>
                </nav>
              </div></header>
            <section class="u-align-center u-clearfix u-grey-5 u-section-1" id="sec-c48b">
              <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
                <div class="u-layout">
                  <div class="u-layout-row">
                    <div class="u-black u-container-style u-layout-cell u-size-15 u-layout-cell-1">
                      <div class="u-border-3 u-border-custom-color-1 u-container-layout u-container-layout-1"><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-1">90+%</h2><a href="G0060.html" data-page-id="G0060" class="u-border-1 u-border-active-custom-color-1 u-border-hover-custom-color-1 u-btn u-button-style u-none u-text-custom-color-1 u-btn-1">BRONZE BUTLER</a><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-2">89% - 80%</h2><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-3">79% - 70%</h2><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-4">69% - 60%</h2><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-5">59% - 50%</h2>
                      </div>
                    </div>
                    <div class="u-black u-container-style u-layout-cell u-size-45 u-layout-cell-2">
                      <div class="u-border-3 u-border-custom-color-1 u-container-layout u-container-layout-2">
                        <h1 class="u-align-left u-text u-text-custom-color-1 u-title u-text-6">BRONZE BUTLER</h1>
                        <p class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-8"><a href="https://attack.mitre.org/groups/G0060">BRONZE BUTLER</a> is a cyber espionage group with likely Chinese origins that has been active since at least 2008. The group primarily targets Japanese organizations, particularly those in government, biotechnology, electronics manufacturing, and industrial chemistry.</p>
                        <h2 class="u-align-left u-subtitle u-text u-text-custom-color-1 u-text-default u-text-9">Associated Groups</h2>
                        <p class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-10">REDBALDKNIGHT, Tick</p>
                         <details>
                             <summary><h2 class="u-align-left u-subtitle u-text u-text-custom-color-1 u-text-default u-text-9">Software</h2></summary>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">ABK</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0469">ABK</a> is a downloader that has been used by <a href="https://attack.mitre.org/groups/G0060">BRONZE BUTLER</a> since at least 2019.</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">Avenger</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0473">Avenger</a> is a downloader that has been used by <a href="https://attack.mitre.org/groups/G0060">BRONZE BUTLER</a> since at least 2019.</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">BBK</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0470">BBK</a> is a downloader that has been used by <a href="https://attack.mitre.org/groups/G0060">BRONZE BUTLER</a> since at least 2019.</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">Daserf</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0187">Daserf</a> is a backdoor that has been used to spy on and steal from Japanese, South Korean, Russian, Singaporean, and Chinese victims. Researchers have identified versions written in both Visual C and Delphi.  </span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">Mimikatz</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0002">Mimikatz</a> is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks.  </span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">Net</span></summary>
                            <p><span style="padding-left: 40px; display:block">The <a href="https://attack.mitre.org/software/S0039">Net</a> utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. 

<a href="https://attack.mitre.org/software/S0039">Net</a> has a great deal of functionality,  much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through <a href="https://attack.mitre.org/techniques/T1021/002">SMB/Windows Admin Shares</a> using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">ShadowPad</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0596">ShadowPad</a> is a modular backdoor that was first identified in a supply chain compromise of the NetSarang software in mid-July 2017. The malware was originally thought to be exclusively used by <a href="https://attack.mitre.org/groups/G0096">APT41</a>, but has since been observed to be used by various Chinese threat activity groups.  </span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">Windows Credential Editor</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0005">Windows Credential Editor</a> is a password dumping tool. </span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">at</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0110">at</a> is used to schedule tasks on a system to run at a specified date or time. </span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">build_downer</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0471">build_downer</a> is a downloader that has been used by <a href="https://attack.mitre.org/groups/G0060">BRONZE BUTLER</a> since at least 2019.</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">cmd</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0106">cmd</a> is the Windows command-line interpreter that can be used to interact with systems and execute other processes and utilities. 

Cmd.exe contains native functionality to perform many operations to interact with the system, including listing files in a directory (e.g., <code>dir</code> ), deleting files (e.g., <code>del</code> ), and copying files (e.g., <code>copy</code> ).</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">down_new</span></summary>
                            <p><span style="padding-left: 40px; display:block"> <a href="https://attack.mitre.org/software/S0472">down_new</a> is a downloader that has been used by <a href="https://attack.mitre.org/groups/G0060">BRONZE BUTLER</a> since at least 2019.</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">gsecdump</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0008">gsecdump</a> is a publicly-available credential dumper used to obtain password hashes and LSA secrets from Windows operating systems. </span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">schtasks</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0111">schtasks</a> is used to schedule execution of programs or scripts on a Windows system to run at a specific date and time. </span></p>
                        </details></details>
                   <details>
                     <summary><h2 class="u-align-left u-subtitle u-text u-text-custom-color-1 u-text-default u-text-9">Techniques</h2></summary>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Archive Collected Data: Archive via Utility</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities. Many utilities exist that can archive data, including 7-Zip, WinRAR, and WinZip. Most utilities include functionality to encrypt and/or compress data.

Some 3rd party utilities may be preinstalled, such as `tar` on Linux and macOS or `zip` on Windows systems.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Scheduled Task/Job: At (Windows)</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse the <code>at.exe</code> utility to perform task scheduling for initial or recurring execution of malicious code. The <a href="https://attack.mitre.org/software/S0110">at</a> utility exists as an executable within Windows for scheduling tasks at a specified time and date. Using <a href="https://attack.mitre.org/software/S0110">at</a> requires that the Task Scheduler service be running, and the user to be logged on as a member of the local Administrators group. 

An adversary may use <code>at.exe</code> in Windows environments to execute programs at system startup or on a scheduled basis for persistence. <a href="https://attack.mitre.org/software/S0110">at</a> can also be abused to conduct remote Execution as part of Lateral Movement and or to run a process under the context of a specified account (such as SYSTEM).

Note: The <code>at.exe</code> command line utility has been deprecated in current versions of Windows in favor of <code>schtasks</code>.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Obfuscated Files or Information: Binary Padding</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This can be done without affecting the functionality or behavior of a binary, but can increase the size of the binary beyond what some security tools are capable of handling due to file size limitations. 

Binary padding effectively changes the checksum of the file and can also be used to avoid hash-based blocklists and static anti-virus signatures. The padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware. Increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files. This may also reduce the likelihood of being collected for analysis. Public file scanning services, such as VirusTotal, limits the maximum size of an uploaded file to be analyzed. </span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Abuse Elevation Control Mechanism: Bypass User Account Control</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action. 

If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevated <a href="https://attack.mitre.org/techniques/T1559/001">Component Object Model</a> objects without prompting the user through the UAC notification box.   An example of this is use of <a href="https://attack.mitre.org/techniques/T1218/011">Rundll32</a> to load a specifically crafted DLL which loads an auto-elevated <a href="https://attack.mitre.org/techniques/T1559/001">Component Object Model</a> object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user.

Many methods have been discovered to bypass UAC. The Github readme page for UACME contains an extensive list of methods that have been discovered and implemented, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:

* <code>eventvwr.exe</code> can auto-elevate and execute a specified binary or script.

Another bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on remote systems and default to high integrity.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p>
                            <p><span style="padding-left: 80px; display:block">Update Software - Perform regular software updates to mitigate exploitation risk.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Control - Configure Windows User Account Control to mitigate risk of adversaries obtaining elevated process access.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Hijack Execution Flow: DLL Side-Loading</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may execute their own malicious payloads by side-loading DLLs. Similar to <a href="https://attack.mitre.org/techniques/T1574/001">DLL Search Order Hijacking</a>, side-loading involves hijacking which DLL a program loads. But rather than just planting the DLL within the search order of a program then waiting for the victim application to be invoked, adversaries may directly side-load their payloads by planting then invoking a legitimate application that executes their payload(s).

Side-loading takes advantage of the DLL search order used by the loader by positioning both the victim application and malicious payload(s) alongside each other. Adversaries likely use side-loading as a means of masking actions they perform under a legitimate, trusted, and potentially elevated system or software process. Benign executables used to side-load payloads may not be flagged during delivery and/or execution. Adversary payloads may also be encrypted/packed or otherwise obfuscated until loaded into the memory of the trusted process.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Application Developer Guidance - This mitigation describes any guidance or training given to developers of applications to avoid introducing security weaknesses that an adversary may be able to take advantage of.</span></p>
                            <p><span style="padding-left: 80px; display:block">Update Software - Perform regular software updates to mitigate exploitation risk.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Data from Local System</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.

Adversaries may do this using a <a href="https://attack.mitre.org/techniques/T1059">Command and Scripting Interpreter</a>, such as <a href="https://attack.mitre.org/software/S0106">cmd</a>, which has functionality to interact with the file system to gather information. Some adversaries may also use <a href="https://attack.mitre.org/techniques/T1119">Automated Collection</a> on the local system.
</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Data Loss Prevention - Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Data from Network Shared Drive</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may search network shares on computers they have compromised to find files of interest. Sensitive data can be collected from remote systems via shared network drives (host shared directory, network file server, etc.) that are accessible from the current system prior to Exfiltration. Interactive command shells may be in use, and common functionality within <a href="https://attack.mitre.org/software/S0106">cmd</a> may be used to gather information.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Web Service: Dead Drop Resolver</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.

Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.

Use of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Deobfuscate/Decode Files or Information</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may use <a href="https://attack.mitre.org/techniques/T1027">Obfuscated Files or Information</a> to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system.

One such example is use of <a href="https://attack.mitre.org/software/S0160">certutil</a> to decode a remote access tool portable executable file that has been hidden inside a certificate file.  Another example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. 

Sometimes a user's action may be required to open it for deobfuscation or decryption as part of <a href="https://attack.mitre.org/techniques/T1204">User Execution</a>. The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. </span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Impair Defenses: Disable or Modify Tools</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take the many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information.

Adversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to <a href="https://attack.mitre.org/techniques/T1562/006">Indicator Blocking</a>, adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Registry Permissions - Restrict the ability to modify certain hives or keys in the Windows Registry.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Account Discovery: Domain Account</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior.

Commands such as <code>net user /domain</code> and <code>net group /domain</code> of the <a href="https://attack.mitre.org/software/S0039">Net</a> utility, <code>dscacheutil -q group</code>on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Drive-by Compromise</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user's web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring <a href="https://attack.mitre.org/techniques/T1550/001">Application Access Token</a>.

Multiple ways of delivering exploit code to a browser exist, including:

* A legitimate website is compromised where adversaries have injected some form of malicious code such as JavaScript, iFrames, and cross-site scripting.
* Malicious ads are paid for and served through legitimate ad providers.
* Built-in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client (e.g. forum posts, comments, and other user controllable web content).

Often the website used by an adversary is one visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted attack is referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.

Typical drive-by compromise process:

1. A user visits a website that is used to host the adversary controlled content.
2. Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version. 
    * The user may be required to assist in this process by enabling scripting or active website components and ignoring warning dialog boxes.
3. Upon finding a vulnerable version, exploit code is delivered to the browser.
4. If exploitation is successful, then it will give the adversary code execution on the user's system unless other protections are in place.
    * In some cases a second visit to the website after the initial scan is required before exploit code is delivered.

Unlike <a href="https://attack.mitre.org/techniques/T1190">Exploit Public-Facing Application</a>, the focus of this technique is to exploit software on a client endpoint upon visiting a website. This will commonly give an adversary access to systems on the internal network instead of external systems that may be in a DMZ.

Adversaries may also use compromised websites to deliver a user to a malicious application designed to <a href="https://attack.mitre.org/techniques/T1528">Steal Application Access Token</a>s, like OAuth tokens, to gain access to protected applications and information. These malicious applications have been delivered through popups on legitimate websites.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Application Isolation and Sandboxing - Restrict execution of code to a virtual environment on or in transit to an endpoint system.</span></p>
                            <p><span style="padding-left: 80px; display:block">Exploit Protection - Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</span></p>
                            <p><span style="padding-left: 80px; display:block">Update Software - Perform regular software updates to mitigate exploitation risk.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Exploitation for Client Execution</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.

Several types exist:

### Browser-based Exploitation

Web browsers are a common target through <a href="https://attack.mitre.org/techniques/T1189">Drive-by Compromise</a> and <a href="https://attack.mitre.org/techniques/T1566/002">Spearphishing Link</a>. Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed.

### Office Applications

Common office and productivity applications such as Microsoft Office are also targeted through <a href="https://attack.mitre.org/techniques/T1566">Phishing</a>. Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run.

### Common Third-party Applications

Other applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Application Isolation and Sandboxing - Restrict execution of code to a virtual environment on or in transit to an endpoint system.</span></p>
                            <p><span style="padding-left: 80px; display:block">Exploit Protection - Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Indicator Removal on Host: File Deletion</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.

There are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native <a href="https://attack.mitre.org/software/S0106">cmd</a> functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. </span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">File and Directory Discovery</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from <a href="https://attack.mitre.org/techniques/T1083">File and Directory Discovery</a> during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>. Custom tools may also be used to gather file and directory information and interact with the <a href="https://attack.mitre.org/techniques/T1106">Native API</a>.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Ingress Tool Transfer</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">OS Credential Dumping: LSASS Memory</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct <a href="https://attack.mitre.org/tactics/TA0008">Lateral Movement</a> using <a href="https://attack.mitre.org/techniques/T1550">Use Alternate Authentication Material</a>.

As well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.

For example, on the target host use procdump:

* <code>procdump -ma lsass.exe lsass_dump</code>

Locally, mimikatz can be run using:

* <code>sekurlsa::Minidump lsassdump.dmp</code>
* <code>sekurlsa::logonPasswords</code>

Built-in Windows tools such as comsvcs.dll can also be used:

* <code>rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump PID  lsass.dmp full</code>


Windows Security Support Provider (SSP) DLLs are loaded into LSSAS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> and <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.

The following SSPs can be used to access credentials:

* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.
* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.
* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.
* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.
</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</span></p>
                            <p><span style="padding-left: 80px; display:block">Credential Access Protection - Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping.</span></p>
                            <p><span style="padding-left: 80px; display:block">Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</span></p>
                            <p><span style="padding-left: 80px; display:block">Password Policies - Set and enforce secure password policies for accounts.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Process Integrity - Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">User Execution: Malicious File</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from <a href="https://attack.mitre.org/techniques/T1566/001">Spearphishing Attachment</a>. Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl.

Adversaries may employ various forms of <a href="https://attack.mitre.org/techniques/T1036">Masquerading</a> on the file to increase the likelihood that a user will open it.

While <a href="https://attack.mitre.org/techniques/T1204/002">Malicious File</a> frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after <a href="https://attack.mitre.org/techniques/T1534">Internal Spearphishing</a>.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Masquerading</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools. Masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. This may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names.

Renaming abusable system utilities to evade security monitoring is also a form of <a href="https://attack.mitre.org/techniques/T1036">Masquerading</a>.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Code Signing - Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Masquerading: Match Legitimate Name or Location</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may match or approximate the name or location of legitimate files or resources when naming/placing them. This is done for the sake of evading defenses and observation. This may be done by placing an executable in a commonly trusted directory (ex: under System32) or giving it the name of a legitimate, trusted program (ex: svchost.exe). In containerized environments, this may also be done by creating a resource in a namespace that matches the naming convention of a container pod or cluster. Alternatively, a file or container image name given may be a close approximation to legitimate programs/images or something innocuous.

Adversaries may also use the same icon of the file they are trying to mimic.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Code Signing - Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Use Alternate Authentication Material: Pass the Ticket</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may pass the ticket using stolen Kerberos tickets to move laterally within an environment, bypassing normal system access controls. Pass the ticket (PtT) is a method of authenticating to a system using Kerberos tickets without having access to an account's password. Kerberos authentication can be used as the first step to lateral movement to a remote system.

When preforming PtT, valid Kerberos tickets for <a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a> are captured by <a href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a>. A user's service tickets or ticket granting ticket (TGT) may be obtained, depending on the level of access. A service ticket allows for access to a particular resource, whereas a TGT can be used to request service tickets from the Ticket Granting Service (TGS) to access any resource the user has privileges to access.

A <a href="https://attack.mitre.org/techniques/T1558/002">Silver Ticket</a> can be obtained for services that use Kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource (e.g., SharePoint).

A <a href="https://attack.mitre.org/techniques/T1558/001">Golden Ticket</a> can be obtained for the domain using the Key Distribution Service account KRBTGT account NTLM hash, which enables generation of TGTs for any account in Active Directory.

Adversaries may also create a valid Kerberos ticket using other user information, such as stolen password hashes or AES keys. For example, "overpassing the hash" involves using a NTLM password hash to authenticate as a user (i.e. <a href="https://attack.mitre.org/techniques/T1550/002">Pass the Hash</a>) while also using the password hash to create a valid Kerberos ticket.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Active Directory Configuration - Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.</span></p>
                            <p><span style="padding-left: 80px; display:block">Password Policies - Set and enforce secure password policies for accounts.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Command and Scripting Interpreter: PowerShell</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system.  Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems).

PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.

A number of PowerShell-based offensive testing tools are available, including <a href="https://attack.mitre.org/software/S0363">Empire</a>,  <a href="https://attack.mitre.org/software/S0194">PowerSploit</a>, <a href="https://attack.mitre.org/software/S0378">PoshC2</a>, and PSAttack.

PowerShell commands/scripts can also be executed without directly invoking the <code>powershell.exe</code> binary through interfaces to PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI). </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Code Signing - Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.</span></p>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Command and Scripting Interpreter: Python</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse Python commands and scripts for execution. Python is a very popular scripting/programming language, with capabilities to perform many functions. Python can be executed interactively from the command-line (via the <code>python.exe</code> interpreter) or via scripts (.py) that can be written and distributed to different systems. Python code can also be compiled into binary executables.

Python comes with many built-in packages to interact with the underlying system, such as file operations and device I/O. Adversaries can use these libraries to download and execute commands or other scripts as well as perform various malicious behaviors.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Limit Software Installation - Block users or groups from installing unapproved software.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the "run keys" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.  These programs will be executed under the context of the user and will have the account's associated permissions level.

Placing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\Users\\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code>. The startup folder path for all users is <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code>.

The following run keys are created by default on Windows systems:

* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>

Run keys may exist under multiple hives. The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.  For example, it is possible to load a DLL at logon using a "Depend" key with RunOnceEx: <code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d "C:\temp\evil[.]dll"</code> 

The following Registry keys can be used to set startup folder items for persistence:

* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code>

The following Registry keys can control automatic startup of services during boot:

* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</code>

Using policy settings to specify startup programs creates corresponding values in either of two Registry keys:

* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>

The Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code> and <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> subkeys can automatically launch programs.

Programs listed in the load value of the registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> run when any user logs on.

By default, the multistring <code>BootExecute</code> value of the registry key <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> is set to <code>autocheck autochk *</code>. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.

Adversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use <a href="https://attack.mitre.org/techniques/T1036">Masquerading</a> to make the Registry entries look as if they are associated with legitimate programs.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Remote System Discovery</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  <a href="https://attack.mitre.org/software/S0097">Ping</a> or <code>net view</code> using <a href="https://attack.mitre.org/software/S0039">Net</a>. Adversaries may also use local host files (ex: <code>C:\Windows\System32\Drivers\etc\hosts</code> or <code>/etc/hosts</code>) in order to discover the hostname to IP address mappings of remote systems. 
</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Masquerading: Right-to-Left Override</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse the right-to-left override (RTLO or RLO) character (U+202E) to disguise a string and/or file name to make it appear benign. RTLO is a non-printing Unicode character that causes the text that follows it to be displayed in reverse. For example, a Windows screensaver executable named <code>March 25 \u202Excod.scr</code> will display as <code>March 25 rcs.docx</code>. A JavaScript file named <code>photo_high_re\u202Egnp.js</code> will be displayed as <code>photo_high_resj.png</code>.

Adversaries may abuse the RTLO character as a means of tricking a user into executing what they think is a benign file type. A common use of this technique is with <a href="https://attack.mitre.org/techniques/T1566/001">Spearphishing Attachment</a>/<a href="https://attack.mitre.org/techniques/T1204/002">Malicious File</a> since it can trick both end users and defenders if they are not aware of how their tools display and render the RTLO character. Use of the RTLO character has been seen in many targeted intrusion attempts and criminal activity. RTLO can be used in the Windows Registry as well, where regedit.exe displays the reversed characters but the command line tool reg.exe does not by default.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Scheduled Task/Job: Scheduled Task</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The <code>schtasks</code> can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel. In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library to create a scheduled task.

The deprecated <a href="https://attack.mitre.org/software/S0110">at</a> utility could also be abused by adversaries (ex: <a href="https://attack.mitre.org/techniques/T1053/002">At (Windows)</a>), though <code>at.exe</code> can not access tasks created with <code>schtasks</code> or the Control Panel.

An adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and or to run a process under the context of a specified account (such as SYSTEM).</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Screen Capture</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations. Taking a screenshot is also typically possible through native utilities or API calls, such as <code>CopyFromScreen</code>, <code>xwd</code>, or <code>screencapture</code>.
</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Software Discovery</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to get a listing of software and software versions that are installed on a system or in a cloud environment. Adversaries may use the information from <a href="https://attack.mitre.org/techniques/T1518">Software Discovery</a> during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable to <a href="https://attack.mitre.org/techniques/T1068">Exploitation for Privilege Escalation</a>.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Phishing: Spearphishing Attachment</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon <a href="https://attack.mitre.org/techniques/T1204">User Execution</a> to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.

There are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</span></p>
                            <p><span style="padding-left: 80px; display:block">Software Configuration - Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Data Encoding: Standard Encoding</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.  Some data encoding systems may also result in data compression, such as gzip.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Obfuscated Files or Information: Steganography</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may use steganography techniques in order to prevent the detection of hidden information. Steganographic techniques can be used to hide data in digital media such as images, audio tracks, video clips, or text files.

<a href="https://attack.mitre.org/software/S0038">Duqu</a> was an early example of malware that used steganography. It encrypted the gathered information from a victim's system and hid it within an image before exfiltrating the image to a C2 server. 

By the end of 2017, a threat group used<code>Invoke-PSImage</code>to hide <a href="https://attack.mitre.org/techniques/T1059/001">PowerShell</a> commands in an image file (.png) and execute the code on a victim's system. In this particular case the <a href="https://attack.mitre.org/techniques/T1059/001">PowerShell</a> code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary.  </span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Encrypted Channel: Symmetric Cryptography</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, and RC4.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">System Service Discovery</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may try to get information about registered services. Commands that may obtain information about services using operating system utilities are "sc," "tasklist /svc" using <a href="https://attack.mitre.org/software/S0057">Tasklist</a>, and "net start" using <a href="https://attack.mitre.org/software/S0039">Net</a>, but adversaries may also use other tools as well. Adversaries may use the information from <a href="https://attack.mitre.org/techniques/T1007">System Service Discovery</a> during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">System Time Discovery</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">An adversary may gather the system time and/or time zone from a local or remote system. The system time is set and stored by the Windows Time Service within a domain to maintain time synchronization between systems and services in an enterprise network.  

System time information may be gathered in a number of ways, such as with <a href="https://attack.mitre.org/software/S0039">Net</a> on Windows by performing <code>net time \\hostname</code> to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using <code>w32tm /tz</code>. 

This information could be useful for performing other techniques, such as executing a file with a <a href="https://attack.mitre.org/techniques/T1053">Scheduled Task/Job</a> , or to discover locality information based on time zone to assist in victim targeting (i.e. <a href="https://attack.mitre.org/techniques/T1614">System Location Discovery</a>). Adversaries may also use knowledge of system time as part of a time bomb, or delaying execution until a specified date/time.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Taint Shared Content</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">
Adversaries may deliver payloads to remote systems by adding content to shared storage locations, such as network drives or internal code repositories. Content stored on network drives or in other shared locations may be tainted by adding malicious programs, scripts, or exploit code to otherwise valid files. Once a user opens the shared tainted content, the malicious portion can be executed to run the adversary's code on a remote system. Adversaries may use tainted shared content to move laterally.

A directory share pivot is a variation on this technique that uses several other techniques to propagate malware when users access a shared network directory. It uses <a href="https://attack.mitre.org/techniques/T1547/009">Shortcut Modification</a> of directory .LNK files that use <a href="https://attack.mitre.org/techniques/T1036">Masquerading</a> to look like the real directories, which are hidden through <a href="https://attack.mitre.org/techniques/T1564/001">Hidden Files and Directories</a>. The malicious .LNK-based directories have an embedded command that executes the hidden malware file in the directory and then opens the real intended directory so that the user's expected action still occurs. When used with frequently used network directories, the technique may result in frequent reinfections and broad access to systems and potentially to new and higher privileged accounts. 

Adversaries may also compromise shared network directories through binary infections by appending or prepending its code to the healthy binary on the shared network directory. The malware may modify the original entry point (OEP) of the healthy binary to ensure that it is executed before the legitimate code. The infection could continue to spread via the newly infected file when it is executed by a remote system. These infections may target both binary and non-binary formats that end with extensions including, but not limited to, .EXE, .DLL, .SCR, .BAT, and/or .VBS.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Exploit Protection - Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Obtain Capabilities: Tool</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may buy, steal, or download software tools that can be used during targeting. Tools can be open or closed source, free or commercial. A tool can be used for malicious purposes by an adversary, but (unlike malware) were not intended to be used for those purposes (ex: <a href="https://attack.mitre.org/software/S0029">PsExec</a>). Tool acquisition can involve the procurement of commercial software licenses, including for red teaming tools such as <a href="https://attack.mitre.org/software/S0154">Cobalt Strike</a>. Commercial software may be obtained through purchase, stealing licenses (or licensed copies of the software), or cracking trial versions.

Adversaries may obtain tools to support their operations, including to support execution of post-compromise behaviors. In addition to freely downloading or purchasing software, adversaries may steal software and/or software licenses from third-party entities (including other adversaries).</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Command and Scripting Interpreter: Visual Basic</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse Visual Basic (VB) for execution. VB is a programming language created by Microsoft with interoperability with many Windows technologies such as <a href="https://attack.mitre.org/techniques/T1559/001">Component Object Model</a> and the <a href="https://attack.mitre.org/techniques/T1106">Native API</a> through the Windows API. Although tagged as legacy with no planned future evolutions, VB is integrated and supported in the .NET Framework and cross-platform .NET Core.

Derivative languages based on VB have also been created, such as Visual Basic for Applications (VBA) and VBScript. VBA is an event-driven programming language built into Microsoft Office, as well as several third-party applications. VBA enables documents to contain macros used to automate the execution of tasks and other functionality on the host. VBScript is a default scripting language on Windows hosts and can also be used in place of <a href="https://attack.mitre.org/techniques/T1059/007">JavaScript</a> on HTML Application (HTA) webpages served to Internet Explorer (though most modern browsers do not come with VBScript support).

Adversaries may use VB payloads to execute malicious commands. Common malicious usage includes automating execution of behaviors with VBScript or embedding VBA content into <a href="https://attack.mitre.org/techniques/T1566/001">Spearphishing Attachment</a> payloads.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</span></p>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Application Layer Protocol: Web Protocols</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Protocols such as HTTP and HTTPS that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Command and Scripting Interpreter: Windows Command Shell</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse the Windows command shell for execution. The Windows command shell (<a href="https://attack.mitre.org/software/S0106">cmd</a>) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via <a href="https://attack.mitre.org/techniques/T1021">Remote Services</a> such as <a href="https://attack.mitre.org/techniques/T1021/004">SSH</a>.

Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems.

Adversaries may leverage <a href="https://attack.mitre.org/software/S0106">cmd</a> to execute various commands and payloads. Common uses include <a href="https://attack.mitre.org/software/S0106">cmd</a> to execute a single command, or abusing <a href="https://attack.mitre.org/software/S0106">cmd</a> interactively with input and output forwarded over a command and control channel.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p></details>
                        </details>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            
            
            <footer class="u-black u-border-3 u-border-custom-color-1 u-clearfix u-footer" id="sec-be64"><div class="u-clearfix u-sheet u-sheet-1">
                <div class="u-align-left u-social-icons u-spacing-10 u-social-icons-1">
                  <a class="u-social-url" target="_blank" data-type="Github" title="Github" href="https://github.com/redbeardmeric/APTAnalyzer"><span class="u-icon u-social-github u-social-icon u-icon-1"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-2f65"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-2f65"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M88,51.3c0-5.5-1.9-10.2-5.3-13.7c0.6-1.3,2.3-6.5-0.5-13.5c0,0-4.2-1.4-14,5.3c-4.1-1.1-8.4-1.7-12.7-1.8
                c-4.3,0-8.7,0.6-12.7,1.8c-9.7-6.6-14-5.3-14-5.3c-2.8,7-1,12.2-0.5,13.5C25,41.2,23,45.7,23,51.3c0,19.6,11.9,23.9,23.3,25.2
                c-1.5,1.3-2.8,3.5-3.2,6.8c-3,1.3-10.2,3.6-14.9-4.3c0,0-2.7-4.9-7.8-5.3c0,0-5-0.1-0.4,3.1c0,0,3.3,1.6,5.6,7.5c0,0,3,9.1,17.2,6
                c0,4.3,0.1,8.3,0.1,9.5h25.2c0-1.7,0.1-7.2,0.1-14c0-4.7-1.7-7.9-3.4-9.4C76,75.2,88,70.9,88,51.3z"></path></svg></span>
                  </a>
                  <a class="u-social-url" target="_blank" data-type="Github" title="MITRE Att&amp;ck" href="https://attack.mitre.org/"><span class="u-file-icon u-icon u-social-github u-social-icon u-icon-2"><img src="images/Attck.jpg" alt=""></span>
                  </a>
                </div>
              </div></footer>
            <section class="u-backlink u-clearfix u-grey-80">
              <a class="u-link" href="https://nicepage.com/templates" target="_blank">
                <span>Template</span>
              </a>
              <p class="u-text">
                <span>created with</span>
              </p>
              <a class="u-link" href="https://nicepage.com/html-website-builder" target="_blank">
                <span>HTML Website Builder</span>
              </a>. 
            </section>
          </body>
        </html>